"use strict";(self.webpackChunkblog_admin=self.webpackChunkblog_admin||[]).push([[233,314],{3233:function(t,e,n){n.r(e),n.d(e,{default:function(){return O}});var r=n(5861),a=n(5671),o=n(3144),i=n(136),c=n(8557),s=n(181);var u=n(7757),l=n.n(u),f=n(7313),d=(n(6314),n(1084)),h=n(2209),p=n(1413),y={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M847.9 592H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h605.2L612.9 851c-4.1 5.2-.4 13 6.3 13h72.5c4.9 0 9.5-2.2 12.6-6.1l168.8-214.1c16.5-21 1.6-51.8-25.2-51.8zM872 356H266.8l144.3-183c4.1-5.2.4-13-6.3-13h-72.5c-4.9 0-9.5 2.2-12.6 6.1L150.9 380.2c-16.5 21-1.6 51.8 25.1 51.8h696c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"swap",theme:"outlined"},v=n(3863),m=function(t,e){return f.createElement(v.Z,(0,p.Z)((0,p.Z)({},t),{},{ref:e,icon:y}))};m.displayName="SwapOutlined";var b=f.forwardRef(m),x=n(9548),g=n(7038),w=n(6417),S=null,j=null,I=null,A=["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],C={xData:Array(12).fill("2020-06"),yData:Array(12).fill(0)},D=[{value:0,name:"\u5e7f\u5dde"},{value:0,name:"\u6df1\u5733"},{value:0,name:"\u4f5b\u5c71"},{value:0,name:"\u4e1c\u839e"},{value:0,name:"\u73e0\u6d77"},{value:0,name:"\u5176\u4ed6"}];function k(t){var e=t.unit,n=t.unitMap,r=t.params,a=t.indicator;if(Array.prototype.isPrototypeOf(r)){var o,i="<div>".concat(r[0].axisValue,"<br/>"),c=function(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=(0,s.Z)(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){c=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}(r);try{for(c.s();!(o=c.n()).done;){var u=o.value;u.seriesName&&(i+="".concat(u.marker).concat(u.seriesName,"&nbsp;&nbsp;&nbsp;&nbsp").concat(u.value," ").concat(e||n[u.seriesName],"<br/>"))}}catch(d){c.e(d)}finally{c.f()}return i+="</div>"}if("pie"===r.seriesType){var l="<div>";return l+="".concat(r.marker," ").concat(r.name,"<br/>").concat(r.value||"0").concat(r.unit||e||"","<br/></div>")}var f="<div>".concat(r.name,"<br/>");return a.forEach((function(t,e){f+=r.marker+t.name+"&nbsp;&nbsp;&nbsp;&nbsp;"+r.value[e]+n[r.name]+"<br/>"})),f+="</div>"}var Z=function(t){(0,i.Z)(n,t);var e=(0,c.Z)(n);function n(t){var o;return(0,a.Z)(this,n),(o=e.call(this,t)).getNowStr=function(){var t=new Date,e=t.getDay(),n=t.getFullYear(),r=t.getMonth()+1,a=t.getDate(),i=t.getHours(),c=t.getMinutes(),s=A[e],u="".concat(i<3?"\u6df1\u591c\u4e86,\u65e9\u70b9\u4f11\u606f\u4e86\u54c8":i<6?"\u51cc\u6668\u4e86,\u6ce8\u610f\u4f11\u606f\u54c8":i<11?"\u4e0a\u5348\u597d":i<13?"\u4e2d\u5348\u597d":i<19?"\u4e0b\u5348\u597d":"\u665a\u4e0a\u597d",",\u73b0\u5728\u662f").concat(n,"\u5e74").concat(r,"\u6708").concat(a,"\u65e5 ").concat(i,":").concat(c," ").concat(s);o.setState({timeStr:u})},o.initChart1=function(){var t=(o.chart1Ref||{}).current;if("undefined"!==typeof t){S=g.init(t);var e={title:{text:"\u8fd1\u4e00\u5e74\u65b0\u589e\u8bbf\u5ba2\u6570\u91cf",textStyle:{color:"#343844",fontSize:15}},xAxis:{type:"category",interval:1,axisLabel:{show:!0},axisTick:{show:!1},data:C.xData},yAxis:{type:"value"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:"rgba(6, 47, 96, 0.8)",borderWidth:0,textStyle:{color:"#fff",fontSize:14},confine:!0,formatter:function(t){return k({unit:"\u4eba",params:t})}},series:[{name:"\u65b0\u589e\u8bbf\u5ba2",data:C.yData,type:"bar",label:{show:!0,position:"top",color:"#000"},itemStyle:{normal:{color:new g.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(4, 54, 141, 1)"},{offset:1,color:"rgba(99, 178, 243, 1)"}])}}}]};S.setOption(e)}},o.fetchData=(0,r.Z)(l().mark((function t(){var e,n,r,a,i,c,s,u,f,d,p,y;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,h.hM)();case 2:if(e=t.sent,r=(n=e||{}).code,a=n.data,200===r){t.next=6;break}return t.abrupt("return");case 6:i=a.guestCityList,c=a.newGuestTrendList,s=a.todayAccssCount,u=a.totalAccessCount,f=a.totalGuestCount,d={todayAccssCount:s,totalAccessCount:u,totalGuestCount:f},o.setState({guestData:d}),C.xData=[],C.yData=[],c.forEach((function(t){var e=t||{},n=e.year,r=e.month,a=e.count;C.xData.push("".concat(n,"-").concat(r)),C.yData.push(a)})),o.initChart1(),D=[],i.sort((function(t,e){return e.count-t.count})),p=i.splice(5),i.forEach((function(t){var e=t||{},n=e.city,r=e.count;D.push({name:n||"\u672a\u77e5\u57ce\u5e02",value:r||0})})),p.length&&(y=0,p.forEach((function(t){return y+=t.count})),D.push({name:"\u5176\u4ed6",value:y})),o.initChart2();case 19:case"end":return t.stop()}}),t)}))),o.chart1Ref=f.createRef(),o.chart2Ref=f.createRef(),o.state={guestData:{},timeStr:""},o}return(0,o.Z)(n,[{key:"initChart2",value:function(){var t=(this.chart2Ref||{}).current,e=this.state.guestData.totalGuestCount;if(e||(e=0),"undefined"!==typeof t){j=g.init(t);var n={tooltip:{trigger:"item",axisPointer:{type:"shadow"},backgroundColor:"rgba(0, 0, 0, 0.6)",borderWidth:0,textStyle:{color:"#fff",fontSize:14},formatter:function(t){return t.unit="\u4eba",k({params:t})}},legend:{icon:"circle",bottom:"0%"},title:[{text:"{name|\u603b\u4eba\u6570}\n{val|"+e+"}",top:"center",left:"center",textStyle:{rich:{name:{fontSize:15,fontWeight:"normal",color:"#000",padding:[10,0]},val:{fontSize:26,fontWeight:"bolder",color:"#000"}}}},{text:"\u8bbf\u5ba2\u57ce\u5e02\u5206\u5e03",textStyle:{color:"#343844",fontSize:15}}],series:[{name:"",aria:{enabled:!0},type:"pie",radius:["30%","60%"],center:["50%","50%"],avoidLabelOverlap:!1,label:{normal:{show:!0,formatter:"{d}% ",textStyle:{fontSize:12,color:"#666"}}},labelLine:{normal:{lineStyle:{color:"#5281B3"},length:15}},emphasis:{label:{show:!0,fontSize:12}},data:D}]},r=0;I=setInterval((function(){j.dispatchAction({type:"downplay",seriesIndex:0}),j.dispatchAction({type:"highlight",seriesIndex:0,dataIndex:r%n.series[0].data.length}),j.dispatchAction({type:"showTip",seriesIndex:0,dataIndex:r%n.series[0].data.length}),r++}),5e3),j.on("mouseover",(function(t){r=t.dataIndex,j.dispatchAction({type:"downplay",seriesIndex:0}),j.dispatchAction({type:"showTip",seriesIndex:1,dataIndex:r%n.series[0].data.length}),j.dispatchAction({type:"highlight",seriesIndex:1,dataIndex:r%n.series[0].data.length})})),j.on("mouseout",(function(t){r=t.dataIndex,j.dispatchAction({type:"downplay",seriesIndex:0}),j.dispatchAction({type:"showTip",seriesIndex:1,dataIndex:r%n.series[0].data.length}),j.dispatchAction({type:"highlight",seriesIndex:1,dataIndex:r%n.series[0].data.length})})),j.setOption(n)}}},{key:"componentDidMount",value:function(){var t=this;setInterval((function(){t.getNowStr()}),1e3),this.fetchData(),this.initChart1(),this.initChart2()}},{key:"componentWillUnmount",value:function(){clearInterval(I),clearInterval(null)}},{key:"render",value:function(){var t=this.state.guestData,e=t.todayAccssCount,n=t.totalAccessCount,r=this.props.userInfo;return(0,w.jsxs)("div",{className:"system-status",children:[(0,w.jsxs)("div",{className:"top",children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)("h6",{children:["\u6b22\u8fce\uff0c",r&&r.userName]}),(0,w.jsx)("h5",{children:this.state.timeStr})]}),(0,w.jsxs)("ul",{children:[(0,w.jsxs)("li",{children:[(0,w.jsx)(x.Z,{}),"\u8bbf\u95ee\u603b\u6570:(",n,")"]}),(0,w.jsxs)("li",{children:[(0,w.jsx)(b,{}),"\u4eca\u65e5\u6d41\u91cf:(",e,")"]})]})]}),(0,w.jsxs)("div",{className:"echarts-wrapper",children:[(0,w.jsx)("div",{ref:this.chart1Ref,className:"echart-container"}),(0,w.jsx)("div",{ref:this.chart2Ref,className:"echart-container"})]}),(0,w.jsx)("footer",{children:(0,w.jsx)("a",{href:"https://github.com/Weison-Zhong",target:"_blank",children:"github"})})]})}}]),n}(f.Component),O=(0,d.$j)((function(t){return{userInfo:t.global.userInfo}}))(Z)},6314:function(t,e,n){n.r(e)},5671:function(t,e,n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,{Z:function(){return r}})},3144:function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}n.d(e,{Z:function(){return a}})},8557:function(t,e,n){function r(t){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},r(t)}n.d(e,{Z:function(){return c}});var a=n(1002),o=n(7326);function i(t,e){if(e&&("object"===(0,a.Z)(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return(0,o.Z)(t)}function c(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,a=r(t);if(e){var o=r(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return i(this,n)}}},136:function(t,e,n){n.d(e,{Z:function(){return a}});var r=n(9611);function a(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&(0,r.Z)(t,e)}}}]);