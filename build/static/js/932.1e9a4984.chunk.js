"use strict";(self.webpackChunkblog_admin=self.webpackChunkblog_admin||[]).push([[932,388],{1361:function(e,n,r){r.d(n,{Z:function(){return p}});var t=r(9439),a=r(7313),s=r(6168),i=r(3752),c=r(5524),u=r(2138),l=r(6417);function o(e){var n=e.imageUrl,r=e.setImageUrl,i=e.fileChange,o=(0,a.useState)(!1),p=(0,t.Z)(o,2),f=p[0],h=p[1];var x=(0,l.jsxs)("div",{children:[f?(0,l.jsx)(c.Z,{}):(0,l.jsx)(u.Z,{}),(0,l.jsx)("div",{style:{marginTop:8},children:"\u70b9\u51fb\u4e0a\u4f20\u56fe\u7247"})]});return(0,l.jsx)(s.Z,{listType:"picture",showUploadList:!1,customRequest:function(){h(!0)},beforeUpload:d,onChange:function(e){var n=e.file.originFileObj;i(n),function(e,n){var r=new FileReader;r.addEventListener("load",(function(){return n(r.result)})),r.readAsDataURL(e)}(n,(function(e){r(e),h(!1)}))},className:"img-upload-container",children:n?(0,l.jsx)("img",{src:n,alt:"avatar",style:{width:"100%"}}):x})}function d(e){var n="image/jpeg"===e.type||"image/jpg"===e.type||"image/png"===e.type;n||i.ZP.error("\u4ec5\u53ef\u4e0a\u4f20png\u6216jpg,jpeg\u683c\u5f0f\u56fe\u7247");var r=e.size/1024/1024<3;return r||i.ZP.error("\u56fe\u7247\u6587\u4ef6\u4e0d\u80fd\u5927\u4e8e 3MB"),n&&r}var p=a.memo(o)},8932:function(e,n,r){r.r(n),r.d(n,{default:function(){return q}});var t=r(3433),a=r(5861),s=r(9439),i=r(7757),c=r.n(i),u=r(7313),l=(r(3388),r(7502)),o=r.n(l),d=r(2209),p=r(4740),f=r(1513),h=r(3752),x=r(8197),m=r(9624),Z=r(685),j=r(6155),g=r(5705),v=r(2555),b=r(6345),k=r(9491),w=r(2652),y=r(2138),C=r(1361),F=r(3830),S=r(2239),U=r(6417),P=p.Z.Item,I=f.Z.Option,N=null;function q(e){var n=u.createRef(),r=(0,u.useState)(""),i=(0,s.Z)(r,2),l=i[0],q=i[1],D=(0,u.useState)([]),L=(0,s.Z)(D,2),R=L[0],T=L[1],E=(0,u.useState)(""),K=(0,s.Z)(E,2),z=K[0],O=K[1],V=(0,u.useState)(!1),_=(0,s.Z)(V,2),A=_[0],B=_[1],M=(0,u.useState)(""),Y=(0,s.Z)(M,2),G=Y[0],H=Y[1],J=(0,u.useState)({}),Q=(0,s.Z)(J,2),W=Q[0],X=Q[1],$=(0,F.k6)(),ee=(0,u.useCallback)((function(e){N=e}),[]),ne=function(){var e=(0,a.Z)(c().mark((function e(){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.KK)();case 2:if(n=e.sent,"undefined"!==typeof(r=n.data)){e.next=6;break}return e.abrupt("return");case 6:T(r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=(0,a.Z)(c().mark((function e(n){var r,t,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(!0),e.next=3,(0,d.Yu)(n);case 3:r=e.sent,B(!1),t=r.data,200===r.code&&(a=t.content,s=t.coverImgUrl,X(t),q(a),O(s));case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),te=function(e){e.preventDefault(),G&&(T([].concat((0,t.Z)(R),[G])),H(""))},ae=function(){var e=(0,a.Z)(c().mark((function e(n){var r,t,a,s,i,u,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in B(!0),e.prev=1,r=(W||{}).id,n.status=Number(n.status),t=new FormData,console.log({antdFormData:n}),n)t.append(a,n[a]);if(t.append("content",l),N&&t.append("coverImage",N),s=null,!r){e.next=16;break}return e.next=13,(0,d.K4)(r,t);case 13:s=e.sent,e.next=19;break;case 16:return e.next=18,(0,d.mF)(t);case 18:s=e.sent;case 19:if(B(!1),u=(i=s).code,o=i.msg,200===u){e.next=23;break}return e.abrupt("return");case 23:N=null,r?(re(r),h.ZP.success(o)):(h.ZP.success("\u65b0\u589e\u6587\u7ae0\u6210\u529f\uff0c\u6b63\u524d\u5f80\u5217\u8868\u9875"),setTimeout((function(){$.push("/article/list")}),500)),e.next=32;break;case 27:e.prev=27,e.t0=e.catch(1),h.ZP.error("\u4fdd\u5b58\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"),B(!1),console.log("Failed:",e.t0);case 32:case"end":return e.stop()}}),e,null,[[1,27]])})));return function(n){return e.apply(this,arguments)}}();return(0,u.useEffect)((function(){ne();var e=((0,S.DP)()||{}).articleId;return e&&re(e),function(){T({}),X({}),q({}),O({}),B({})}}),[]),(0,u.useEffect)((function(){n.current&&n.current.setFieldsValue(W)}),[W,n]),(0,U.jsxs)("div",{className:"article-edit",children:[(0,U.jsx)(p.Z,{ref:n,className:"form",onFinish:ae,children:(0,U.jsxs)(x.Z,{gutter:2,children:[(0,U.jsxs)(m.Z,{span:16,children:[(0,U.jsx)(P,{name:"title",label:"\u6807\u9898",rules:[{required:!0}],children:(0,U.jsx)(Z.Z,{allowClear:!0})}),(0,U.jsx)(P,{name:"relatedLink",label:"\u94fe\u63a5",rules:[{required:!1}],children:(0,U.jsx)(Z.Z,{allowClear:!0})}),(0,U.jsxs)(x.Z,{gutter:2,children:[(0,U.jsx)(m.Z,{span:12,children:(0,U.jsx)(P,{name:"articleType",label:"\u7c7b\u578b",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7c7b\u578b"}],children:(0,U.jsx)(f.Z,{style:{width:220},placeholder:"\u8bf7\u9009\u62e9\u6587\u7ae0\u7c7b\u578b",dropdownRender:function(e){return(0,U.jsxs)(U.Fragment,{children:[e,(0,U.jsx)(j.Z,{style:{margin:"8px 0"}}),(0,U.jsxs)(g.Z,{align:"center",style:{padding:"0 8px 4px"},children:[(0,U.jsx)(Z.Z,{placeholder:"\u65b0\u589e\u6587\u7ae0\u7c7b\u578b",value:G,onChange:function(e){return H(e.target.value)}}),(0,U.jsx)(v.Z.Link,{onClick:te,style:{whiteSpace:"nowrap"},children:(0,U.jsx)(y.Z,{})})]})]})},children:R.map((function(e){return(0,U.jsx)(I,{children:e},e)}))})})}),(0,U.jsx)(m.Z,{span:6,children:(0,U.jsx)(P,{label:"\u72b6\u6001",name:"status",rules:[{required:!1}],valuePropName:"checked",initialValue:!0,children:(0,U.jsx)(b.Z,{checkedChildren:"\u4e0a\u67b6",unCheckedChildren:"\u9690\u85cf"})})}),(0,U.jsx)(m.Z,{span:6,children:(0,U.jsx)(P,{children:(0,U.jsx)(k.Z,{type:"primary",htmlType:"submit",children:"\u4fdd\u5b58\u6587\u7ae0"})})})]})]}),(0,U.jsx)(m.Z,{span:8,children:(0,U.jsx)(P,{className:"img-upload-container",children:(0,U.jsx)(C.Z,{imageUrl:z,setImageUrl:O,fileChange:ee})})})]})}),(0,U.jsx)(o(),{subfield:!0,preview:!0,value:l,onChange:function(e){return q(e)}}),(0,U.jsx)(w.Z,{delay:800,size:"large",tip:"\u52a0\u8f7d\u4e2d\xb7\xb7\xb7",spinning:A})]})}},3388:function(e,n,r){r.r(n)}}]);