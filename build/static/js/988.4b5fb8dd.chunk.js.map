{"version":3,"file":"static/js/988.4b5fb8dd.chunk.js","mappings":"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","sources":["components/DeleteModal/index.jsx","components/FormModal/index.jsx","pages/api-list/index.jsx"],"sourcesContent":["import React from \"react\";\r\nimport { Modal } from \"antd\";\r\nexport default function DeleteModal(props) {\r\n  const { deletingObj, onDelete, setDeletingObj } = props;\r\n  const { id, title, name } = deletingObj;\r\n  return (\r\n    <Modal\r\n      visible={id}\r\n      // confirmLoading={isDeleting}\r\n      closable={false}\r\n      onOk={onDelete}\r\n      onCancel={() => {\r\n        setDeletingObj({});\r\n      }}\r\n    >\r\n      确定要删除: {name || title} 吗?\r\n    </Modal>\r\n  );\r\n}\r\n","import { useEffect, useRef } from \"react\";\r\nimport { Modal, Form, Button } from \"antd\";\r\nimport { LoadingOutlined } from \"@ant-design/icons\";\r\nconst { Item } = Form;\r\n\r\nexport default function FormModal(props) {\r\n  const form = Form.useForm()[0];\r\n  const formRef = useRef();\r\n  const {\r\n    isShowModal,\r\n    setIsShowModal,\r\n    isSubmitting,\r\n    updatingObj,\r\n    setUpdatingObj,\r\n    title,\r\n    submitBtnCallBack,\r\n    initialValues,\r\n    formConfig,\r\n    children,\r\n  } = props;\r\n  const { width, layout, tailLayout } = formConfig || {};\r\n  const handleModalClose = () => {\r\n    setUpdatingObj({});\r\n    resetFormData();\r\n  };\r\n  const resetFormData = () => form.resetFields();\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n      formRef.current && formRef.current.setFieldsValue(updatingObj);\r\n    }, 0);\r\n  });\r\n  return (\r\n    <Modal\r\n      title={(updatingObj.id ? \"修改\" : \"新增\") + title}\r\n      visible={isShowModal}\r\n      footer={null}\r\n      destroyOnClose={true} //可防止Form的initialValues动态更新时延迟问题（读取到的是上次state）\r\n      afterClose={handleModalClose}\r\n      onCancel={() => {\r\n        setIsShowModal(false);\r\n      }}\r\n      width={width}\r\n    >\r\n      <Form\r\n        {...layout}\r\n        form={form}\r\n        ref={formRef}\r\n        initialValues={initialValues}\r\n        onFinish={submitBtnCallBack}\r\n      >\r\n        {children}\r\n        <Item {...tailLayout}>\r\n          <Button\r\n            type=\"primary\"\r\n            htmlType=\"submit\"\r\n            icon={isSubmitting ? <LoadingOutlined /> : null}\r\n          >\r\n            {isSubmitting ? \"提交中\" : \"提交\"}\r\n          </Button>\r\n          <Button\r\n            htmlType=\"button\"\r\n            onClick={resetFormData}\r\n            style={{\r\n              display: \"inline-block\",\r\n              marginLeft: \"10px\",\r\n            }}\r\n          >\r\n            重置所有\r\n          </Button>\r\n        </Item>\r\n      </Form>\r\n    </Modal>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { Button, Table, Form, Input, message, Select } from \"antd\";\r\nimport { FormOutlined, DeleteOutlined } from \"@ant-design/icons\";\r\nimport {\r\n  addApiApi,\r\n  deleteApiApi,\r\n  updateApiApi,\r\n  getApisApi,\r\n  getMenusApi,\r\n} from \"../../axios/api\";\r\nimport FormModal from \"@/components/FormModal\";\r\nimport DeleteModal from \"@/components/DeleteModal\";\r\nconst { Item } = Form;\r\nconst { Option } = Select;\r\nconst formConfig = {\r\n  width: 550,\r\n  layout: {\r\n    labelCol: { span: 6 },\r\n    wrapperCol: { span: 16 },\r\n  },\r\n  tailLayout: {\r\n    wrapperCol: { offset: 6, span: 16 },\r\n  },\r\n};\r\n\r\nexport default function ApiList() {\r\n  const [isShowModal, setIsShowModal] = useState(false);\r\n  const [updatingApi, setUpdatingApi] = useState({});\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [deletingApi, setDeletingApi] = useState({});\r\n  const [ApiList, setApiList] = useState([]);\r\n  const [menuList, setMenuList] = useState([]);\r\n  const columns = [\r\n    {\r\n      title: \"序号\",\r\n      dataIndex: \"index\",\r\n      key: \"index\",\r\n      width: 60,\r\n      align: \"center\",\r\n    },\r\n    {\r\n      title: \"接口名\",\r\n      dataIndex: \"title\",\r\n      key: \"title\",\r\n      ellipsis: true,\r\n      textWrap: \"word-break\",\r\n      width: 150,\r\n      align: \"center\",\r\n    },\r\n    {\r\n      title: \"路径\",\r\n      dataIndex: \"key\",\r\n      key: \"key\",\r\n      ellipsis: true,\r\n      textWrap: \"word-break\",\r\n      width: 300,\r\n      align: \"center\",\r\n    },\r\n    {\r\n      title: \"所属菜单\",\r\n      width: 200,\r\n      dataIndex: \"createdDate\",\r\n      align: \"center\",\r\n      render: (_, row) => {\r\n        const { menuName } = row.menu || {};\r\n        return menuName;\r\n      },\r\n    },\r\n    {\r\n      title: \"说明\",\r\n      dataIndex: \"description\",\r\n      align: \"center\",\r\n    },\r\n    {\r\n      title: \"操作\",\r\n      key: \"operation\",\r\n      width: 130,\r\n      align: \"center\",\r\n      render: (row) => {\r\n        return (\r\n          <div>\r\n            <Button\r\n              type=\"primary\"\r\n              icon={<FormOutlined />}\r\n              onClick={() => handleEditApiClick(row)}\r\n            />\r\n            <Button\r\n              type=\"primary\"\r\n              danger\r\n              icon={<DeleteOutlined />}\r\n              style={{\r\n                display: \"inline-block\",\r\n                marginLeft: \"10px\",\r\n              }}\r\n              onClick={() => handleDeleteApiClick(row)}\r\n            />\r\n          </div>\r\n        );\r\n      },\r\n    },\r\n  ];\r\n  function handleDeleteApiClick(row) {\r\n    setDeletingApi(row);\r\n  }\r\n  async function fetchApis() {\r\n    const res = await getApisApi();\r\n    //若axios没有加全局拦截器，那么走不到这里，控制台会报Uncaught (in promise) Error错误，但是如果上面await那里加了catch则可以继续执行，res是undefined;\r\n    //若axios的interceptors.response.use()第二个参数有处理，则返回我们return的东西。\r\n    const { code, data } = res || {};\r\n    console.log({ res });\r\n    if (code !== 200) return;\r\n    data.forEach((item, i) => (item.index = i + 1));\r\n    setApiList(data);\r\n  }\r\n  //请求菜单数据并摊平一维数组\r\n  async function fetchMenus() {\r\n    const res = await getMenusApi();\r\n    const { code, data } = res || {};\r\n    if (code !== 200) return;\r\n    setMenuList(data);\r\n  }\r\n  //新增或修改API\r\n  const handleSubmit = async (newApi) => {\r\n    const { id } = updatingApi;\r\n    setIsSubmitting(true);\r\n    let res = null;\r\n    if (id) {\r\n      //修改\r\n      newApi.id = id;\r\n      res = await updateApiApi(newApi);\r\n    } else {\r\n      //新增\r\n      res = await addApiApi(newApi);\r\n    }\r\n    setIsSubmitting(false);\r\n    const { code, msg } = res || {};\r\n    if (code !== 200) return;\r\n    message.success(msg);\r\n    setIsShowModal(false);\r\n    fetchApis();\r\n  };\r\n  //删除Api\r\n  async function handleDeleteApi() {\r\n    const { id } = deletingApi || {};\r\n    if (!id) return;\r\n    const res = await deleteApiApi(id);\r\n    const { code, msg } = res || {};\r\n    if (code !== 200) return;\r\n    message.success(msg);\r\n    setDeletingApi({});\r\n    fetchApis();\r\n  }\r\n  //修改Api按钮\r\n  function handleEditApiClick(row) {\r\n    setUpdatingApi(row);\r\n    setIsShowModal(true);\r\n  }\r\n  //初始化\r\n  useEffect(() => {\r\n    fetchApis();\r\n    fetchMenus();\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"api-list\">\r\n      <div className=\"content-container\">\r\n        <Button type=\"primary\" onClick={() => setIsShowModal(true)}>\r\n          添加Api\r\n        </Button>\r\n        <Table columns={columns} dataSource={ApiList} rowKey=\"id\" />\r\n      </div>\r\n      <FormModal\r\n        formConfig={formConfig}\r\n        title={\"Api\"}\r\n        isShowModal={isShowModal}\r\n        setIsShowModal={setIsShowModal}\r\n        isSubmitting={isSubmitting}\r\n        updatingObj={updatingApi}\r\n        setUpdatingObj={setUpdatingApi}\r\n        submitBtnCallBack={handleSubmit}\r\n        initialValues={{ menuId: updatingApi.menu && updatingApi.menu.menuId }}\r\n      >\r\n        <Item name=\"title\" label=\"Api名\" rules={[{ required: true }]}>\r\n          <Input allowClear={true} />\r\n        </Item>\r\n        <Item name=\"key\" label=\"路径\" rules={[{ required: true }]}>\r\n          <Input allowClear={true} />\r\n        </Item>\r\n        <Item name=\"description\" label=\"说明\" rules={[{ required: false }]}>\r\n          <Input.TextArea allowClear={true} />\r\n        </Item>\r\n        <Item name=\"menuId\" label=\"所属菜单\" rules={[{ required: false }]}>\r\n          <Select\r\n            style={{ width: 220 }}\r\n            placeholder=\"请选择所属菜单\"\r\n            showSearch\r\n            optionFilterProp=\"children\"\r\n            filterOption={(input, option) => {\r\n              const children = option.children.toString();\r\n              if (typeof children === \"undefined\") {\r\n                return null;\r\n              } else {\r\n                return children.toLowerCase().indexOf(input.toLowerCase()) >= 0;\r\n              }\r\n            }}\r\n          >\r\n            {menuList.map((item) => (\r\n              <Option key={item.id}>{item.name}</Option>\r\n            ))}\r\n          </Select>\r\n        </Item>\r\n      </FormModal>\r\n      <DeleteModal\r\n        deletingObj={deletingApi}\r\n        setDeletingObj={setDeletingApi}\r\n        onDelete={handleDeleteApi}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":["DeleteModal","props","deletingObj","onDelete","setDeletingObj","id","title","name","visible","closable","onOk","onCancel","Item","Form","FormModal","form","formRef","useRef","isShowModal","setIsShowModal","isSubmitting","updatingObj","setUpdatingObj","submitBtnCallBack","initialValues","formConfig","children","width","layout","tailLayout","resetFormData","resetFields","useEffect","setTimeout","current","setFieldsValue","footer","destroyOnClose","afterClose","ref","onFinish","type","htmlType","icon","onClick","style","display","marginLeft","Option","Select","labelCol","span","wrapperCol","offset","ApiList","useState","updatingApi","setUpdatingApi","setIsSubmitting","deletingApi","setDeletingApi","setApiList","menuList","setMenuList","columns","dataIndex","key","align","ellipsis","textWrap","render","_","row","menu","menuName","handleEditApiClick","danger","handleDeleteApiClick","fetchApis","getApisApi","res","code","data","console","log","forEach","item","i","index","getMenusApi","handleSubmit","newApi","updateApiApi","addApiApi","msg","message","deleteApiApi","fetchMenus","className","dataSource","rowKey","menuId","label","rules","required","allowClear","placeholder","showSearch","optionFilterProp","filterOption","input","option","toString","toLowerCase","indexOf","map"],"sourceRoot":""}