"use strict";(self.webpackChunkblog_admin=self.webpackChunkblog_admin||[]).push([[282,314],{8282:function(t,e,a){a.r(e);var n=a(5861),r=a(5671),o=a(3144),i=a(136),s=a(8557),c=a(7762),l=a(7757),u=a.n(l),d=a(7313),h=(a(6314),a(1084)),f=a(2209),p=a(9548),v=a(3685),m=a(4210),x=a(6417),y=null,g=null,b=null,S=["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],I={xData:Array(12).fill("2020-06"),yData:Array(12).fill(0)},w=[{value:0,name:"\u5e7f\u5dde"},{value:0,name:"\u6df1\u5733"},{value:0,name:"\u4f5b\u5c71"},{value:0,name:"\u4e1c\u839e"},{value:0,name:"\u73e0\u6d77"},{value:0,name:"\u5176\u4ed6"}];function C(t){var e=t.unit,a=t.unitMap,n=t.params,r=t.indicator;if(Array.prototype.isPrototypeOf(n)){var o,i="<div>".concat(n[0].axisValue,"<br/>"),s=(0,c.Z)(n);try{for(s.s();!(o=s.n()).done;){var l=o.value;l.seriesName&&(i+="".concat(l.marker).concat(l.seriesName,"&nbsp;&nbsp;&nbsp;&nbsp").concat(l.value," ").concat(e||a[l.seriesName],"<br/>"))}}catch(h){s.e(h)}finally{s.f()}return i+="</div>"}if("pie"===n.seriesType){var u="<div>";return u+="".concat(n.marker," ").concat(n.name,"<br/>").concat(n.value||"0").concat(n.unit||e||"","<br/></div>")}var d="<div>".concat(n.name,"<br/>");return r.forEach((function(t,e){d+=n.marker+t.name+"&nbsp;&nbsp;&nbsp;&nbsp;"+n.value[e]+a[n.name]+"<br/>"})),d+="</div>"}var A=function(t){(0,i.Z)(a,t);var e=(0,s.Z)(a);function a(t){var o;return(0,r.Z)(this,a),(o=e.call(this,t)).getNowStr=function(){var t=new Date,e=t.getDay(),a=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),i=t.getHours(),s=t.getMinutes(),c=S[e],l="".concat(i<3?"\u6df1\u591c\u4e86,\u65e9\u70b9\u4f11\u606f\u4e86\u54c8":i<6?"\u51cc\u6668\u4e86,\u6ce8\u610f\u4f11\u606f\u54c8":i<11?"\u4e0a\u5348\u597d":i<13?"\u4e2d\u5348\u597d":i<19?"\u4e0b\u5348\u597d":"\u665a\u4e0a\u597d",",\u73b0\u5728\u662f").concat(a,"\u5e74").concat(n,"\u6708").concat(r,"\u65e5 ").concat(i,":").concat(s," ").concat(c);o.setState({timeStr:l})},o.initChart1=function(){var t=(o.chart1Ref||{}).current;if("undefined"!==typeof t){y=m.S1(t);var e={title:{text:"\u8fd1\u4e00\u5e74\u65b0\u589e\u8bbf\u5ba2\u6570\u91cf",textStyle:{color:"#343844",fontSize:15}},xAxis:{type:"category",interval:1,axisLabel:{show:!0},axisTick:{show:!1},data:I.xData},yAxis:{type:"value"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:"rgba(6, 47, 96, 0.8)",borderWidth:0,textStyle:{color:"#fff",fontSize:14},confine:!0,formatter:function(t){return C({unit:"\u4eba",params:t})}},series:[{name:"\u65b0\u589e\u8bbf\u5ba2",data:I.yData,type:"bar",label:{show:!0,position:"top",color:"#000"},itemStyle:{normal:{color:new m.Q.o(0,0,0,1,[{offset:0,color:"rgba(4, 54, 141, 1)"},{offset:1,color:"rgba(99, 178, 243, 1)"}])}}}]};y.setOption(e)}},o.fetchData=(0,n.Z)(u().mark((function t(){var e,a,n,r,i,s,c,l,d,h,p,v;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,f.hM)();case 2:if(e=t.sent,n=(a=e||{}).code,r=a.data,200===n){t.next=6;break}return t.abrupt("return");case 6:i=r.guestCityList,s=r.newGuestTrendList,c=r.todayAccssCount,l=r.totalAccessCount,d=r.totalGuestCount,h={todayAccssCount:c,totalAccessCount:l,totalGuestCount:d},o.setState({guestData:h}),I.xData=[],I.yData=[],s.forEach((function(t){var e=t||{},a=e.year,n=e.month,r=e.count;I.xData.push("".concat(a,"-").concat(n)),I.yData.push(r)})),o.initChart1(),w=[],i.sort((function(t,e){return e.count-t.count})),p=i.splice(5),i.forEach((function(t){var e=t||{},a=e.city,n=e.count;w.push({name:a||"\u672a\u77e5\u57ce\u5e02",value:n||0})})),p.length&&(v=0,p.forEach((function(t){return v+=t.count})),w.push({name:"\u5176\u4ed6",value:v})),o.initChart2();case 19:case"end":return t.stop()}}),t)}))),o.chart1Ref=d.createRef(),o.chart2Ref=d.createRef(),o.state={guestData:{},timeStr:""},o}return(0,o.Z)(a,[{key:"initChart2",value:function(){var t=(this.chart2Ref||{}).current,e=this.state.guestData.totalGuestCount;if(e||(e=0),"undefined"!==typeof t){g=m.S1(t);var a={tooltip:{trigger:"item",axisPointer:{type:"shadow"},backgroundColor:"rgba(0, 0, 0, 0.6)",borderWidth:0,textStyle:{color:"#fff",fontSize:14},formatter:function(t){return t.unit="\u4eba",C({params:t})}},legend:{icon:"circle",bottom:"0%"},title:[{text:"{name|\u603b\u4eba\u6570}\n{val|"+e+"}",top:"center",left:"center",textStyle:{rich:{name:{fontSize:15,fontWeight:"normal",color:"#000",padding:[10,0]},val:{fontSize:26,fontWeight:"bolder",color:"#000"}}}},{text:"\u8bbf\u5ba2\u57ce\u5e02\u5206\u5e03",textStyle:{color:"#343844",fontSize:15}}],series:[{name:"",aria:{enabled:!0},type:"pie",radius:["30%","60%"],center:["50%","50%"],avoidLabelOverlap:!1,label:{normal:{show:!0,formatter:"{d}% ",textStyle:{fontSize:12,color:"#666"}}},labelLine:{normal:{lineStyle:{color:"#5281B3"},length:15}},emphasis:{label:{show:!0,fontSize:12}},data:w}]},n=0;b=setInterval((function(){g.dispatchAction({type:"downplay",seriesIndex:0}),g.dispatchAction({type:"highlight",seriesIndex:0,dataIndex:n%a.series[0].data.length}),g.dispatchAction({type:"showTip",seriesIndex:0,dataIndex:n%a.series[0].data.length}),n++}),5e3),g.on("mouseover",(function(t){n=t.dataIndex,g.dispatchAction({type:"downplay",seriesIndex:0}),g.dispatchAction({type:"showTip",seriesIndex:1,dataIndex:n%a.series[0].data.length}),g.dispatchAction({type:"highlight",seriesIndex:1,dataIndex:n%a.series[0].data.length})})),g.on("mouseout",(function(t){n=t.dataIndex,g.dispatchAction({type:"downplay",seriesIndex:0}),g.dispatchAction({type:"showTip",seriesIndex:1,dataIndex:n%a.series[0].data.length}),g.dispatchAction({type:"highlight",seriesIndex:1,dataIndex:n%a.series[0].data.length})})),g.setOption(a)}}},{key:"componentDidMount",value:function(){var t=this;setInterval((function(){t.getNowStr()}),1e3),this.fetchData(),this.initChart1(),this.initChart2()}},{key:"componentWillUnmount",value:function(){clearInterval(b),clearInterval(null)}},{key:"render",value:function(){var t=this.state.guestData,e=t.todayAccssCount,a=t.totalAccessCount,n=this.props.userInfo;return(0,x.jsxs)("div",{className:"system-status",children:[(0,x.jsxs)("div",{className:"top",children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("h6",{children:["\u6b22\u8fce\uff0c",n&&n.userName]}),(0,x.jsx)("h5",{children:this.state.timeStr})]}),(0,x.jsxs)("ul",{children:[(0,x.jsxs)("li",{children:[(0,x.jsx)(p.Z,{}),"\u8bbf\u95ee\u603b\u6570:(",e,")"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)(v.Z,{}),"\u4eca\u65e5\u6d41\u91cf:(",a,")"]})]})]}),(0,x.jsxs)("div",{className:"echarts-wrapper",children:[(0,x.jsx)("div",{ref:this.chart1Ref,className:"echart-container"}),(0,x.jsx)("div",{ref:this.chart2Ref,className:"echart-container"})]})]})}}]),a}(d.Component);e.default=(0,h.$j)((function(t){return{userInfo:t.global.userInfo}}))(A)},6314:function(t,e,a){a.r(e)}}]);