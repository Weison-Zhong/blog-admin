"use strict";(self.webpackChunkblog_admin=self.webpackChunkblog_admin||[]).push([[233,314],{3453:function(t,e,n){n.r(e),n.d(e,{default:function(){return Z}});var a=n(5861),r=n(5671),i=n(3144),o=n(136),s=n(8557),c=n(181);var l=n(7757),u=n.n(l),h=n(7313),d=(n(6314),n(1084)),f=n(2209),p=n(1413),v={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M847.9 592H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h605.2L612.9 851c-4.1 5.2-.4 13 6.3 13h72.5c4.9 0 9.5-2.2 12.6-6.1l168.8-214.1c16.5-21 1.6-51.8-25.2-51.8zM872 356H266.8l144.3-183c4.1-5.2.4-13-6.3-13h-72.5c-4.9 0-9.5 2.2-12.6 6.1L150.9 380.2c-16.5 21-1.6 51.8 25.1 51.8h696c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"swap",theme:"outlined"},m=n(7469),y=function(t,e){return h.createElement(m.Z,(0,p.Z)((0,p.Z)({},t),{},{ref:e,icon:v}))};y.displayName="SwapOutlined";var x=h.forwardRef(y),g=n(9548),b=n(7038),w=n(6417),S=null,I=null,A=null,C=["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],D={xData:Array(12).fill("2020-06"),yData:Array(12).fill(0)},j=[{value:0,name:"\u5e7f\u5dde"},{value:0,name:"\u6df1\u5733"},{value:0,name:"\u4f5b\u5c71"},{value:0,name:"\u4e1c\u839e"},{value:0,name:"\u73e0\u6d77"},{value:0,name:"\u5176\u4ed6"}];function k(t){var e=t.unit,n=t.unitMap,a=t.params,r=t.indicator;if(Array.prototype.isPrototypeOf(a)){var i,o="<div>".concat(a[0].axisValue,"<br/>"),s=function(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=(0,c.Z)(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}(a);try{for(s.s();!(i=s.n()).done;){var l=i.value;l.seriesName&&(o+="".concat(l.marker).concat(l.seriesName,"&nbsp;&nbsp;&nbsp;&nbsp").concat(l.value," ").concat(e||n[l.seriesName],"<br/>"))}}catch(d){s.e(d)}finally{s.f()}return o+="</div>"}if("pie"===a.seriesType){var u="<div>";return u+="".concat(a.marker," ").concat(a.name,"<br/>").concat(a.value||"0").concat(a.unit||e||"","<br/></div>")}var h="<div>".concat(a.name,"<br/>");return r.forEach((function(t,e){h+=a.marker+t.name+"&nbsp;&nbsp;&nbsp;&nbsp;"+a.value[e]+n[a.name]+"<br/>"})),h+="</div>"}var N=function(t){(0,o.Z)(n,t);var e=(0,s.Z)(n);function n(t){var i;return(0,r.Z)(this,n),(i=e.call(this,t)).getNowStr=function(){var t=new Date,e=t.getDay(),n=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),o=t.getHours(),s=t.getMinutes(),c=C[e],l="".concat(o<3?"\u6df1\u591c\u4e86,\u65e9\u70b9\u4f11\u606f\u4e86\u54c8":o<6?"\u51cc\u6668\u4e86,\u6ce8\u610f\u4f11\u606f\u54c8":o<11?"\u4e0a\u5348\u597d":o<13?"\u4e2d\u5348\u597d":o<19?"\u4e0b\u5348\u597d":"\u665a\u4e0a\u597d",",\u73b0\u5728\u662f").concat(n,"\u5e74").concat(a,"\u6708").concat(r,"\u65e5 ").concat(o,":").concat(s," ").concat(c);i.setState({timeStr:l})},i.initChart1=function(){var t=(i.chart1Ref||{}).current;if("undefined"!==typeof t){S=b.init(t);var e={title:{text:"\u8fd1\u4e00\u5e74\u65b0\u589e\u8bbf\u5ba2\u6570\u91cf",textStyle:{color:"#343844",fontSize:15}},xAxis:{type:"category",interval:1,axisLabel:{show:!0},axisTick:{show:!1},data:D.xData},yAxis:{type:"value"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},backgroundColor:"rgba(6, 47, 96, 0.8)",borderWidth:0,textStyle:{color:"#fff",fontSize:14},confine:!0,formatter:function(t){return k({unit:"\u4eba",params:t})}},series:[{name:"\u65b0\u589e\u8bbf\u5ba2",data:D.yData,type:"bar",label:{show:!0,position:"top",color:"#000"},itemStyle:{normal:{color:new b.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(4, 54, 141, 1)"},{offset:1,color:"rgba(99, 178, 243, 1)"}])}}}]};S.setOption(e)}},i.fetchData=(0,a.Z)(u().mark((function t(){var e,n,a,r,o,s,c,l,h,d,p,v;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,f.hM)();case 2:if(e=t.sent,a=(n=e||{}).code,r=n.data,200===a){t.next=6;break}return t.abrupt("return");case 6:o=r.guestCityList,s=r.newGuestTrendList,c=r.todayAccssCount,l=r.totalAccessCount,h=r.totalGuestCount,d={todayAccssCount:c,totalAccessCount:l,totalGuestCount:h},i.setState({guestData:d}),D.xData=[],D.yData=[],s.forEach((function(t){var e=t||{},n=e.year,a=e.month,r=e.count;D.xData.push("".concat(n,"-").concat(a)),D.yData.push(r)})),i.initChart1(),j=[],o.sort((function(t,e){return e.count-t.count})),p=o.splice(5),o.forEach((function(t){var e=t||{},n=e.city,a=e.count;j.push({name:n||"\u672a\u77e5\u57ce\u5e02",value:a||0})})),p.length&&(v=0,p.forEach((function(t){return v+=t.count})),j.push({name:"\u5176\u4ed6",value:v})),i.initChart2();case 19:case"end":return t.stop()}}),t)}))),i.chart1Ref=h.createRef(),i.chart2Ref=h.createRef(),i.state={guestData:{},timeStr:""},i}return(0,i.Z)(n,[{key:"initChart2",value:function(){var t=(this.chart2Ref||{}).current,e=this.state.guestData.totalGuestCount;if(e||(e=0),"undefined"!==typeof t){I=b.init(t);var n={tooltip:{trigger:"item",axisPointer:{type:"shadow"},backgroundColor:"rgba(0, 0, 0, 0.6)",borderWidth:0,textStyle:{color:"#fff",fontSize:14},formatter:function(t){return t.unit="\u4eba",k({params:t})}},legend:{icon:"circle",bottom:"0%"},title:[{text:"{name|\u603b\u4eba\u6570}\n{val|"+e+"}",top:"center",left:"center",textStyle:{rich:{name:{fontSize:15,fontWeight:"normal",color:"#000",padding:[10,0]},val:{fontSize:26,fontWeight:"bolder",color:"#000"}}}},{text:"\u8bbf\u5ba2\u57ce\u5e02\u5206\u5e03",textStyle:{color:"#343844",fontSize:15}}],series:[{name:"",aria:{enabled:!0},type:"pie",radius:["30%","60%"],center:["50%","50%"],avoidLabelOverlap:!1,label:{normal:{show:!0,formatter:"{d}% ",textStyle:{fontSize:12,color:"#666"}}},labelLine:{normal:{lineStyle:{color:"#5281B3"},length:15}},emphasis:{label:{show:!0,fontSize:12}},data:j}]},a=0;A=setInterval((function(){I.dispatchAction({type:"downplay",seriesIndex:0}),I.dispatchAction({type:"highlight",seriesIndex:0,dataIndex:a%n.series[0].data.length}),I.dispatchAction({type:"showTip",seriesIndex:0,dataIndex:a%n.series[0].data.length}),a++}),5e3),I.on("mouseover",(function(t){a=t.dataIndex,I.dispatchAction({type:"downplay",seriesIndex:0}),I.dispatchAction({type:"showTip",seriesIndex:1,dataIndex:a%n.series[0].data.length}),I.dispatchAction({type:"highlight",seriesIndex:1,dataIndex:a%n.series[0].data.length})})),I.on("mouseout",(function(t){a=t.dataIndex,I.dispatchAction({type:"downplay",seriesIndex:0}),I.dispatchAction({type:"showTip",seriesIndex:1,dataIndex:a%n.series[0].data.length}),I.dispatchAction({type:"highlight",seriesIndex:1,dataIndex:a%n.series[0].data.length})})),I.setOption(n)}}},{key:"componentDidMount",value:function(){var t=this;setInterval((function(){t.getNowStr()}),1e3),this.fetchData(),this.initChart1(),this.initChart2()}},{key:"componentWillUnmount",value:function(){clearInterval(A),clearInterval(null)}},{key:"render",value:function(){var t=this.state.guestData,e=t.todayAccssCount,n=t.totalAccessCount,a=this.props.userInfo;return(0,w.jsxs)("div",{className:"system-status",children:[(0,w.jsxs)("div",{className:"top",children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)("h6",{children:["\u6b22\u8fce\uff0c",a&&a.userName]}),(0,w.jsx)("h5",{children:this.state.timeStr})]}),(0,w.jsxs)("ul",{children:[(0,w.jsxs)("li",{children:[(0,w.jsx)(g.Z,{}),"\u8bbf\u95ee\u603b\u6570:(",n,")"]}),(0,w.jsxs)("li",{children:[(0,w.jsx)(x,{}),"\u4eca\u65e5\u6d41\u91cf:(",e,")"]})]})]}),(0,w.jsxs)("div",{className:"echarts-wrapper",children:[(0,w.jsx)("div",{ref:this.chart1Ref,className:"echart-container"}),(0,w.jsx)("div",{ref:this.chart2Ref,className:"echart-container"})]}),(0,w.jsx)("footer",{children:(0,w.jsx)("a",{href:"https://github.com/Weison-Zhong",target:"_blank",children:"github"})})]})}}]),n}(h.Component),Z=(0,d.$j)((function(t){return{userInfo:t.global.userInfo}}))(N)},6314:function(t,e,n){n.r(e)}}]);