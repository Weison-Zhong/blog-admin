"use strict";(self.webpackChunkblog_admin=self.webpackChunkblog_admin||[]).push([[645,395],{6172:function(e,t,n){var r=n(7313),i=n(416),a=n(6417);function s(e){var t=e.deletingObj,n=e.onDelete,r=e.setDeletingObj,s=t.id,c=t.title,l=t.name;return(0,a.jsxs)(i.Z,{visible:s,closable:!1,onOk:n,onCancel:function(){r({})},children:["\u786e\u5b9a\u8981\u5220\u9664: ",l||c," \u5417?"]})}t.Z=r.memo(s)},645:function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var r=n(5987),i=n(5861),a=n(5671),s=n(3144),c=n(136),l=n(8557),o=n(1413),u=n(7757),d=n.n(u),f=n(7313),h=n(3752),g=n(685),p=n(5705),x=n(9491),y=n(6345),k=n(4709),m=n(2652),v=(n(6395),n(765)),w=n(5491),Z=n(7515),b=n(5566),C=n.n(b),j=n(2209),S=n(5395),D=n(6172),A=n(7573),L=n(4378),T=n(6417),I=["className","style"],N=null,P=(0,A.W6)((function(){return(0,T.jsx)(L.Z,{style:{cursor:"grab",color:"#999"}})})),E=(0,A.W8)((function(e){return(0,T.jsx)("tr",(0,o.Z)({},e))})),z=(0,A.JN)((function(e){return(0,T.jsx)("tbody",(0,o.Z)({},e))})),O=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var s;return(0,a.Z)(this,n),(s=t.call(this,e)).onSortEnd=function(){var e=(0,i.Z)(d().mark((function e(t){var n,r,i,a,c,l,o,u,f;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.state,r=n.articleList,i=n.isLoading,a=t.oldIndex,c=t.newIndex,(l=a-c)&&!i){e.next=5;break}return e.abrupt("return");case 5:return s.setState({isLoading:!0}),o=r[a],u=(o||{}).id,e.next=10,(0,j.O7)(u,{diff:l});case 10:f=e.sent,200===(f||{}).code?(s.fetchArticleList(),h.ZP.success("\u6392\u5e8f\u6210\u529f")):h.ZP.error("\u91cd\u65b0\u6392\u5e8f\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"),s.setState({isLoading:!1});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.DraggableContainer=function(e){return(0,T.jsx)(z,(0,o.Z)({useDragHandle:!0,disableAutoscroll:!0,helperClass:"row-dragging",onSortEnd:s.onSortEnd},e))},s.DraggableBodyRow=function(e){e.className,e.style;var t=(0,r.Z)(e,I),n=s.state.articleList.findIndex((function(e){return e.index===t["data-row-key"]}));return(0,T.jsx)(E,(0,o.Z)({index:n},t))},s.fetchArticleList=(0,i.Z)(d().mark((function e(){var t,n,r,i,a,c;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={PageNumber:1,PageSize:999},e.next=3,(0,j.wD)(t);case 3:if(n=e.sent,i=(r=n||{}).code,a=r.data,200===i){e.next=7;break}return e.abrupt("return");case 7:c=(a||{}).articles,(0,S.kJ)(c)&&(c.forEach((function(e,t){return e.index=t+1})),s.setState({articleList:c}));case 9:case"end":return e.stop()}}),e)}))),s.fetchArticleTypes=(0,i.Z)(d().mark((function e(){var t,n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.KK)();case 2:if(t=e.sent,"undefined"!==typeof(n=t.data)){e.next=6;break}return e.abrupt("return");case 6:s.setState({articleTypes:n});case 7:case"end":return e.stop()}}),e)}))),s.handleEditArticleClick=function(e){s.props.history.push("/article/edit?articleId=".concat(e.id))},s.handleDeleteArticleClick=function(e){s.setState({deletingArticle:e})},s.handleToggleStatusClick=function(){var e=(0,i.Z)(d().mark((function e(t){var n,r,i,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.setState({loading:!0}),e.next=3,(0,j.YN)(t.id);case 3:n=e.sent,i=(r=n||{}).code,a=r.msg,200===i&&(h.ZP.success(a),s.fetchArticleList()),s.setState({loading:!1});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.handleDeleteArticle=(0,i.Z)(d().mark((function e(){var t,n,r,i,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=s.state.deletingArticle||{},!(n=t.id)){e.next=11;break}return e.next=4,(0,j.Nz)(n);case 4:if(r=e.sent,a=(i=r||{}).msg,200===i.code){e.next=8;break}return e.abrupt("return");case 8:s.fetchArticleList(),h.ZP.success(a),s.setState({deletingArticle:{}});case 11:case"end":return e.stop()}}),e)}))),s.setDeletingArticle=function(e){s.setState({deletingArticle:e})},s.getColumnSearchProps=function(e){return{filterDropdown:function(t){var n=t.setSelectedKeys,r=t.selectedKeys,i=t.confirm,a=t.clearFilters;return(0,T.jsxs)("div",{style:{padding:8,width:300},children:[(0,T.jsx)(g.Z,{ref:function(e){N=e},placeholder:"\u8bf7\u8f93\u5165\u540d\u79f0\u5173\u952e\u5b57",value:r[0],onChange:function(e){return n(e.target.value?[e.target.value]:[])},onPressEnter:function(){return s.handleSearch(r,i,e)},style:{marginBottom:8,display:"block"}}),(0,T.jsxs)(p.Z,{children:[(0,T.jsx)(x.Z,{type:"primary",onClick:function(){return s.handleSearch(r,i,e)},icon:(0,T.jsx)(v.Z,{}),size:"small",style:{width:90},children:"\u641c\u7d22"}),(0,T.jsx)(x.Z,{onClick:function(){return s.handleReset(a)},size:"small",style:{width:90},children:"\u91cd\u7f6e\u5173\u952e\u5b57"})]})]})},filterIcon:function(e){return(0,T.jsx)(v.Z,{style:{color:e?"#1890ff":void 0}})},onFilter:function(t,n){return n[e]?n[e].toString().toLowerCase().includes(t.toLowerCase()):""},onFilterDropdownVisibleChange:function(e){e&&setTimeout((function(){return N.select()}),100)},render:function(t){return s.state.searchedColumn===e?(0,T.jsx)(C(),{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[s.state.searchText],autoEscape:!0,textToHighlight:t?t.toString():""}):t}}},s.handleSearch=function(e,t,n){t(),s.setState({searchText:e[0],searchedColumn:n})},s.handleReset=function(e){e(),s.setState({searchText:""})},s.state={articleList:[],articleTypes:[],loading:!1,deletingArticle:{},searchText:"",searchedColumn:"",isLoading:!1},s}return(0,s.Z)(n,[{key:"componentDidMount",value:function(){this.fetchArticleList(),this.fetchArticleTypes()}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"render",value:function(){var e=this,t=this.state,n=t.articleList,r=t.loading,i=t.deletingArticle,a=t.articleTypes,s=t.isLoading,c=[{title:"\u6392\u5e8f",dataIndex:"sort",width:60,className:"drag-visible",align:"center",render:function(){return(0,T.jsx)(P,{})}},{title:"\u5e8f\u53f7",width:80,dataIndex:"index",align:"center"},{title:"\u7c7b\u578b",dataIndex:"articleType",key:"articleType",width:120,align:"center",filters:a.map((function(e){return{text:e,value:e}})),filterSearch:!0,onFilter:function(e,t){return t.articleType.includes(e)}},(0,o.Z)({title:"\u6807\u9898",dataIndex:"title",key:"title",ellipsis:!0,textWrap:"word-break",align:"center"},this.getColumnSearchProps("title")),{title:"\u9605\u8bfb\u6570",dataIndex:"readCount",key:"readCount",width:90,align:"center",sorter:function(e,t){return e.readCount-t.readCount}},{title:"\u66f4\u65b0\u65f6\u95f4",width:160,key:"updatedDate",dataIndex:"updatedDate",align:"center",sorter:function(e,t){return Date.parse(e.updatedDate)-Date.parse(t.updatedDate)}},{title:"\u5c55\u793a",width:80,key:"status",dataIndex:"status",align:"center",filters:[{text:"\u5c55\u793a",value:1},{text:"\u9690\u85cf",value:0}],onFilter:function(e,t){return t.status===e},render:function(t,n){return(0,T.jsx)(y.Z,{checked:t,loading:r,onChange:function(){return e.handleToggleStatusClick(n)}})}},{title:"\u64cd\u4f5c",key:"operation",width:130,align:"center",render:function(t){return(0,T.jsxs)("div",{children:[(0,T.jsx)(x.Z,{type:"primary",icon:(0,T.jsx)(w.Z,{}),onClick:function(){return e.handleEditArticleClick(t)}}),(0,T.jsx)(x.Z,{type:"primary",danger:!0,icon:(0,T.jsx)(Z.Z,{}),style:{display:"inline-block",marginLeft:"10px"},onClick:function(){return e.handleDeleteArticleClick(t)}})]})}}];return(0,T.jsxs)("div",{className:"article-list",children:[(0,T.jsx)("div",{className:"content-container",children:(0,T.jsx)(k.Z,{columns:c,dataSource:n,rowKey:"index",components:{body:{wrapper:this.DraggableContainer,row:this.DraggableBodyRow}},scroll:{y:"calc(100vh - 180px)"},pagination:{showSizeChanger:!0}})}),(0,T.jsx)(D.Z,{deletingObj:i,setDeletingObj:this.setDeletingArticle,onDelete:this.handleDeleteArticle}),(0,T.jsx)(m.Z,{delay:800,size:"large",tip:"\u91cd\u65b0\u6392\u5e8f\u4e2d\xb7\xb7\xb7",spinning:s})]})}}]),n}(f.Component)},6395:function(e,t,n){n.r(t)}}]);