{"version":3,"file":"static/js/822.a5119d8c.chunk.js","mappings":"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","sources":["components/DeleteModal/index.jsx","components/FormModal/index.jsx","components/ImgUpload/index.jsx","pages/user-list/index.jsx"],"sourcesContent":["import React from \"react\";\r\nimport { Modal } from \"antd\";\r\nexport default function DeleteModal(props) {\r\n  const { deletingObj, onDelete, setDeletingObj } = props;\r\n  const { id, title, name } = deletingObj;\r\n  return (\r\n    <Modal\r\n      visible={id}\r\n      // confirmLoading={isDeleting}\r\n      closable={false}\r\n      onOk={onDelete}\r\n      onCancel={() => {\r\n        setDeletingObj({});\r\n      }}\r\n    >\r\n      确定要删除: {name || title} 吗?\r\n    </Modal>\r\n  );\r\n}\r\n","import { useEffect, useRef } from \"react\";\r\nimport { Modal, Form, Button } from \"antd\";\r\nimport { LoadingOutlined } from \"@ant-design/icons\";\r\nconst { Item } = Form;\r\n\r\nexport default function FormModal(props) {\r\n  const form = Form.useForm()[0];\r\n  const formRef = useRef();\r\n  const {\r\n    isShowModal,\r\n    setIsShowModal,\r\n    isSubmitting,\r\n    updatingObj,\r\n    setUpdatingObj,\r\n    title,\r\n    submitBtnCallBack,\r\n    initialValues,\r\n    formConfig,\r\n    children,\r\n  } = props;\r\n  const { width, layout, tailLayout } = formConfig || {};\r\n  const handleModalClose = () => {\r\n    setUpdatingObj({});\r\n    resetFormData();\r\n  };\r\n  const resetFormData = () => form.resetFields();\r\n  useEffect(() => {\r\n    setTimeout(() => {\r\n      formRef.current && formRef.current.setFieldsValue(updatingObj);\r\n    }, 0);\r\n  });\r\n  return (\r\n    <Modal\r\n      title={(updatingObj.id ? \"修改\" : \"新增\") + title}\r\n      visible={isShowModal}\r\n      footer={null}\r\n      destroyOnClose={true} //可防止Form的initialValues动态更新时延迟问题（读取到的是上次state）\r\n      afterClose={handleModalClose}\r\n      onCancel={() => {\r\n        setIsShowModal(false);\r\n      }}\r\n      width={width}\r\n    >\r\n      <Form\r\n        {...layout}\r\n        form={form}\r\n        ref={formRef}\r\n        initialValues={initialValues}\r\n        onFinish={submitBtnCallBack}\r\n      >\r\n        {children}\r\n        <Item {...tailLayout}>\r\n          <Button\r\n            type=\"primary\"\r\n            htmlType=\"submit\"\r\n            icon={isSubmitting ? <LoadingOutlined /> : null}\r\n          >\r\n            {isSubmitting ? \"提交中\" : \"提交\"}\r\n          </Button>\r\n          <Button\r\n            htmlType=\"button\"\r\n            onClick={resetFormData}\r\n            style={{\r\n              display: \"inline-block\",\r\n              marginLeft: \"10px\",\r\n            }}\r\n          >\r\n            重置所有\r\n          </Button>\r\n        </Item>\r\n      </Form>\r\n    </Modal>\r\n  );\r\n}\r\n","import React, { useState } from \"react\";\r\nimport { message, Upload } from \"antd\";\r\nimport { LoadingOutlined, PlusOutlined } from \"@ant-design/icons\";\r\nimport \"./index.less\";\r\n\r\nexport default function ImgUpload(props) {\r\n  const { imageUrl, setImageUrl, fileChange } = props;\r\n  const [loading, setLoading] = useState(false);\r\n  const handleUpload = () => {\r\n    setLoading(true);\r\n  };\r\n  //图片改变时，生成base64的url仅用于本地预览\r\n  function handleChange(info) {\r\n    const { originFileObj } = info.file;\r\n    fileChange(originFileObj); //修改真实图片对象引用，当保存时转换为formdata传给后台\r\n    getBase64(originFileObj, (imageUrl) => {\r\n      setImageUrl(imageUrl);\r\n      setLoading(false);\r\n    });\r\n  }\r\n  const uploadButton = (\r\n    <div>\r\n      {loading ? <LoadingOutlined /> : <PlusOutlined />}\r\n      <div style={{ marginTop: 8 }}>点击上传图片</div>\r\n    </div>\r\n  );\r\n  return (\r\n    <Upload\r\n      listType=\"picture\"\r\n      showUploadList={false}\r\n      customRequest={handleUpload}\r\n      beforeUpload={beforeUpload}\r\n      onChange={handleChange}\r\n      className=\"img-upload-container\"\r\n    >\r\n      {imageUrl ? (\r\n        <img src={imageUrl} alt=\"avatar\" style={{ width: \"100%\" }} />\r\n      ) : (\r\n        uploadButton\r\n      )}\r\n    </Upload>\r\n  );\r\n}\r\n\r\nfunction getBase64(img, callback) {\r\n  const reader = new FileReader();\r\n  reader.addEventListener(\"load\", () => callback(reader.result));\r\n  reader.readAsDataURL(img);\r\n}\r\n\r\nfunction beforeUpload(file) {\r\n  const isJpgOrPng =\r\n    file.type === \"image/jpeg\" ||\r\n    file.type === \"image/jpg\" ||\r\n    file.type === \"image/png\";\r\n  if (!isJpgOrPng) {\r\n    message.error(\"仅可上传png或jpg,jpeg格式图片\");\r\n  }\r\n  const isLt3M = file.size / 1024 / 1024 < 3;\r\n  if (!isLt3M) {\r\n    message.error(\"图片文件不能大于 3MB\");\r\n  }\r\n  return isJpgOrPng && isLt3M;\r\n}\r\n","import { Button, Table, message, Form, Input, Select } from \"antd\";\r\nimport \"./index.less\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport FormModal from \"@/components/FormModal\";\r\nimport DeleteModal from \"@/components/DeleteModal\";\r\nimport {\r\n  getUsersApi,\r\n  deleteUserApi,\r\n  addUserApi,\r\n  updateUserApi,\r\n  getRolesApi,\r\n} from \"@/axios/api\";\r\nimport { FormOutlined, DeleteOutlined } from \"@ant-design/icons\";\r\nimport ImgUpload from \"@/components/ImgUpload\";\r\nconst { Item } = Form;\r\nconst { Option } = Select;\r\nconst formConfig = {\r\n  width: 420,\r\n  layout: {\r\n    labelCol: { span: 4 },\r\n    wrapperCol: { span: 20 },\r\n  },\r\n  tailLayout: {\r\n    wrapperCol: { offset: 4, span: 20 },\r\n  },\r\n};\r\nconst pwdValidator = (_rule, value) => {\r\n  if (!value) {\r\n    return Promise.reject(new Error(\"请输入密码\"));\r\n  } else if (value.length > 12) {\r\n    return Promise.reject(new Error(\"密码不能大于12位\"));\r\n  } else if (value.length < 6) {\r\n    return Promise.reject(new Error(\"密码不能小于于6位\"));\r\n  } else if (!/^\\w+$/.test(value)) {\r\n    return Promise.reject(new Error(\"请检查密码格式\"));\r\n  }\r\n  return Promise.resolve();\r\n};\r\nlet imgFile = null;\r\nexport default function UserList() {\r\n  const [isShowModal, setIsShowModal] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [deletingUser, setDeletingUser] = useState({});\r\n  const [updatingUser, setUpdatingUser] = useState({});\r\n  const [userList, setUserList] = useState([]);\r\n  const [roleList, setRoleList] = useState([]);\r\n  const [imageUrl, setImageUrl] = useState(\"\");\r\n  const columns = [\r\n    {\r\n      title: \"序号\",\r\n      width: 80,\r\n      dataIndex: \"index\",\r\n      align: \"center\",\r\n    },\r\n    {\r\n      title: \"头像\",\r\n      key: \"avatar\",\r\n      width: 120,\r\n      align: \"center\",\r\n      render: (_, row) => {\r\n        return <img className=\"avatar\" src={row.avatarUrl} />;\r\n      },\r\n    },\r\n    {\r\n      title: \"用户名\",\r\n      dataIndex: \"name\",\r\n      key: \"name\",\r\n      ellipsis: true,\r\n      textWrap: \"word-break\",\r\n      align: \"center\",\r\n    },\r\n    {\r\n      title: \"角色名\",\r\n      key: \"userName\",\r\n      width: 230,\r\n      align: \"center\",\r\n      render: (_, row) => {\r\n        const { roleName } = row.role || {};\r\n        return roleName;\r\n      },\r\n    },\r\n    {\r\n      title: \"创建时间\",\r\n      width: 180,\r\n      dataIndex: \"createdDate\",\r\n      align: \"center\",\r\n    },\r\n    {\r\n      title: \"操作\",\r\n      key: \"operation\",\r\n      width: 130,\r\n      align: \"center\",\r\n      render: (row) => {\r\n        return (\r\n          <div>\r\n            <Button\r\n              type=\"primary\"\r\n              icon={<FormOutlined />}\r\n              onClick={() => handleEditUserClick(row)}\r\n            />\r\n            <Button\r\n              type=\"primary\"\r\n              danger\r\n              icon={<DeleteOutlined />}\r\n              style={{\r\n                display: \"inline-block\",\r\n                marginLeft: \"10px\",\r\n              }}\r\n              onClick={() => handleDeleteUserClick(row)}\r\n            />\r\n          </div>\r\n        );\r\n      },\r\n    },\r\n  ];\r\n\r\n  const fetchUsers = async () => {\r\n    const res = await getUsersApi();\r\n    const { code, data } = res || {};\r\n    console.log({ res });\r\n    if (code !== 200) return;\r\n    data.forEach((item, i) => (item.index = i + 1));\r\n    setUserList(data);\r\n  };\r\n  const fetchRoles = async () => {\r\n    const res = await getRolesApi();\r\n    const { code, data } = res;\r\n    if (code !== 200) return;\r\n    setRoleList(data);\r\n  };\r\n  const handleEditUserClick = (row) => {\r\n    setUpdatingUser(row);\r\n    const { avatarUrl } = row || {};\r\n    setImageUrl(avatarUrl);\r\n    setIsShowModal(true);\r\n  };\r\n  const handleDeleteUserClick = (row) => {\r\n    setDeletingUser(row);\r\n  };\r\n\r\n  const handleSubmit = async (newRole) => {\r\n    const { id } = updatingUser;\r\n    setIsSubmitting(true);\r\n    let res = null;\r\n    const form = new FormData();\r\n    for (let key in newRole) {\r\n      form.append(key, newRole[key]);\r\n    }\r\n    form.append(\"avatarImg\", imgFile);\r\n    if (isSubmitting) return;\r\n    setIsSubmitting(true);\r\n    if (id) {\r\n      //修改\r\n      res = await updateUserApi(id, form);\r\n    } else {\r\n      //新增\r\n      res = await addUserApi(form);\r\n    }\r\n    setIsSubmitting(false);\r\n    const { code, msg } = res || {};\r\n    if (code !== 200) return;\r\n    message.success(msg);\r\n    setIsShowModal(false);\r\n    fetchUsers();\r\n  };\r\n  const handleDeleteRole = async () => {\r\n    const { id } = deletingUser || {};\r\n    if (!id) return;\r\n    const res = await deleteUserApi(id);\r\n    const { code, msg } = res || {};\r\n    if (code !== 200) return;\r\n    message.success(msg);\r\n    setDeletingUser({});\r\n    fetchUsers();\r\n  };\r\n  useEffect(() => {\r\n    fetchUsers();\r\n    fetchRoles();\r\n  }, []);\r\n  return (\r\n    <div className=\"user-list\">\r\n      <div className=\"content-container\">\r\n        <Button type=\"primary\" onClick={() => setIsShowModal(true)}>\r\n          新增用户\r\n        </Button>\r\n        <Table columns={columns} dataSource={userList} rowKey=\"id\" />\r\n      </div>\r\n      <FormModal\r\n        formConfig={formConfig}\r\n        title={\"用户\"}\r\n        isShowModal={isShowModal}\r\n        setIsShowModal={setIsShowModal}\r\n        isSubmitting={isSubmitting}\r\n        updatingObj={updatingUser}\r\n        setUpdatingObj={setUpdatingUser}\r\n        submitBtnCallBack={handleSubmit}\r\n        initialValues={{\r\n          roleId: updatingUser.role && updatingUser.role.roleId,\r\n        }}\r\n      >\r\n        <Item name=\"name\" label=\"用户名\" rules={[{ required: true }]}>\r\n          <Input allowClear={true} />\r\n        </Item>\r\n        <Item\r\n          name=\"password\"\r\n          label=\"密码\"\r\n          rules={[{ validator: pwdValidator, required: true }]}\r\n        >\r\n          <Input.Password allowClear={true} />\r\n        </Item>\r\n        <Item\r\n          name=\"roleId\"\r\n          label=\"角色\"\r\n          rules={[{ required: true, message: \"请选择角色\" }]}\r\n        >\r\n          <Select\r\n            showSearch\r\n            placeholder=\"请选择角色\"\r\n            optionFilterProp=\"children\"\r\n            filterOption={(input, option) => {\r\n              const children = option.children.toString();\r\n              if (typeof children === \"undefined\") {\r\n                return null;\r\n              } else {\r\n                return children.toLowerCase().indexOf(input.toLowerCase()) >= 0;\r\n              }\r\n            }}\r\n          >\r\n            {roleList.map((item) => (\r\n              <Option value={item.id} key={item.id}>\r\n                {item.name}\r\n              </Option>\r\n            ))}\r\n          </Select>\r\n        </Item>\r\n        <Item label=\"头像\" className=\"avatar-upload\">\r\n          <ImgUpload\r\n            imageUrl={imageUrl}\r\n            setImageUrl={setImageUrl}\r\n            fileChange={(originFileObj) => {\r\n              imgFile = originFileObj;\r\n              console.log({ imgFile });\r\n            }}\r\n          />\r\n        </Item>\r\n      </FormModal>\r\n      <DeleteModal\r\n        deletingObj={deletingUser}\r\n        setDeletingObj={setDeletingUser}\r\n        onDelete={handleDeleteRole}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":["DeleteModal","props","deletingObj","onDelete","setDeletingObj","id","title","name","visible","closable","onOk","onCancel","Item","Form","FormModal","form","formRef","useRef","isShowModal","setIsShowModal","isSubmitting","updatingObj","setUpdatingObj","submitBtnCallBack","initialValues","formConfig","children","width","layout","tailLayout","resetFormData","resetFields","useEffect","setTimeout","current","setFieldsValue","footer","destroyOnClose","afterClose","ref","onFinish","type","htmlType","icon","onClick","style","display","marginLeft","ImgUpload","imageUrl","setImageUrl","fileChange","useState","loading","setLoading","uploadButton","LoadingOutlined","PlusOutlined","marginTop","listType","showUploadList","customRequest","beforeUpload","onChange","info","originFileObj","file","img","callback","reader","FileReader","addEventListener","result","readAsDataURL","getBase64","className","src","alt","isJpgOrPng","message","isLt3M","size","Option","Select","labelCol","span","wrapperCol","offset","pwdValidator","_rule","value","length","Promise","reject","Error","test","resolve","imgFile","UserList","setIsSubmitting","deletingUser","setDeletingUser","updatingUser","setUpdatingUser","userList","setUserList","roleList","setRoleList","columns","dataIndex","align","key","render","_","row","avatarUrl","ellipsis","textWrap","role","roleName","handleEditUserClick","danger","handleDeleteUserClick","fetchUsers","getUsersApi","res","code","data","console","log","forEach","item","i","index","fetchRoles","getRolesApi","handleSubmit","newRole","FormData","append","updateUserApi","addUserApi","msg","handleDeleteRole","deleteUserApi","dataSource","rowKey","roleId","label","rules","required","allowClear","validator","showSearch","placeholder","optionFilterProp","filterOption","input","option","toString","toLowerCase","indexOf","map"],"sourceRoot":""}